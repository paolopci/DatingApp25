<form #registerForm="ngForm" (ngSubmit)="register()" autocomplete="off" class="flex flex-col gap-4 w-full max-w-md mx-auto p-6 bg-base-200 rounded-xl shadow-lg">
  <h2 class="text-2xl font-bold text-center text-primary mb-4">Registrati</h2>
  
  <div class="form-control">
    <label class="label">
      <span class="label-text">Email</span>
    </label>
    <input
      type="email"
      name="email"
      [(ngModel)]="model.email"
      placeholder="Inserisci la tua email"
      class="input input-bordered w-full"
      required
      email
      #email="ngModel"
    />
    @if (email.invalid && (email.dirty || email.touched)) {
      <div class="label text-error text-sm p-1">
        @if (email.errors?.['required']) { <span>Campo obbligatorio</span> }
        @if (email.errors?.['email']) { <span>Formato email non valido</span> }
      </div>
    }
  </div>

  <div class="form-control">
    <label class="label">
      <span class="label-text">Nome Visualizzato</span>
    </label>
    <input
      type="text"
      name="displayName"
      [(ngModel)]="model.displayName"
      placeholder="Come vuoi apparire agli altri?"
      class="input input-bordered w-full"
      required
      #displayName="ngModel"
    />
    @if (displayName.invalid && (displayName.dirty || displayName.touched)) {
      <div class="label text-error text-sm p-1">
        <span>Campo obbligatorio</span>
      </div>
    }
  </div>

  <div class="form-control">
    <label class="label">
      <span class="label-text">Password</span>
    </label>
    <input
      type="password"
      name="password"
      [(ngModel)]="model.password"
      placeholder="Inserisci una password (min 4 caratteri)"
      class="input input-bordered w-full"
      required
      minlength="4"
      #password="ngModel"
    />
    @if (password.invalid && (password.dirty || password.touched)) {
      <div class="label text-error text-sm p-1">
        @if (password.errors?.['required']) { <span>Campo obbligatorio</span> }
        @if (password.errors?.['minlength']) { <span>La password deve avere almeno 4 caratteri</span> }
      </div>
    }
  </div>

  <div class="form-control">
    <label class="label">
      <span class="label-text">Conferma Password</span>
    </label>
    <input
      type="password"
      name="confirmPassword"
      [(ngModel)]="model.confirmPassword"
      placeholder="Conferma la tua password"
      class="input input-bordered w-full"
      required
      #confirmPassword="ngModel"
    />
    @if ((confirmPassword.dirty || confirmPassword.touched)) {
      <div class="label text-error text-sm p-1">
        @if (confirmPassword.invalid && confirmPassword.errors?.['required']) { <span>Campo obbligatorio</span> }
        @if (!confirmPassword.invalid && model.password !== model.confirmPassword) { <span>Le password non coincidono</span> }
      </div>
    }
  </div>

  <div class="form-control">
    <label class="label">
      <span class="label-text">URL Immagine (opzionale)</span>
    </label>
    <input
      type="text"
      name="imageUrl"
      [(ngModel)]="model.imageUrl"
      placeholder="Inserisci l'URL della tua foto"
      class="input input-bordered w-full"
    />
  </div>

  <div class="flex items-center justify-center gap-3 mt-6">
    <button 
      type="submit" 
      class="btn btn-primary px-8"
      [disabled]="!registerForm.valid || model.password !== model.confirmPassword"
    >
      Registrati
    </button>
    <button type="button" (click)="cancel()" class="btn btn-ghost">Annulla</button>
  </div>
</form>
